<div class="container account-management">
  <div class="section">
    <h4 class="white-text center-align">Manage your membership</h4>
    <p class="grey-text text-lighten-3 center-align">Renew, pause, or explore new plans with a single click.</p>
  </div>

  <div class="row">
    <div class="col s12 m6">
      <div class="card blue-grey darken-2">
        <div class="card-content white-text">
          <span class="card-title">Current status</span>
          {{#if subscription}}
            <p class="status">Status: {{subscription.status}}</p>
            {{#if subscription.plan}}
              <p>Plan: {{subscription.plan.name}}</p>
              {{#if subscription.renewsOnFormatted}}
                <p>Renews on: {{subscription.renewsOnFormatted}}</p>
              {{/if}}
              {{#if subscription.trialEndsAtFormatted}}
                <p>Trial ends: {{subscription.trialEndsAtFormatted}}</p>
              {{/if}}
            {{/if}}
            <div class="card-action">
              <form class="membership-action" data-membership-action="renew" data-subscription-id="{{subscription.id}}">
                <button class="btn waves-effect waves-light teal" type="submit">Renew</button>
              </form>
              <form class="membership-action" data-membership-action="cancel" data-subscription-id="{{subscription.id}}">
                <button class="btn waves-effect waves-light red darken-2" type="submit">Cancel</button>
              </form>
            </div>
          {{else}}
            <p>No active subscription found. Activate one of the plans below to get started.</p>
          {{/if}}
        </div>
      </div>
    </div>
    <div class="col s12 m6">
      <div class="card blue-grey darken-1">
        <div class="card-content white-text">
          <span class="card-title">Premium catalogue access</span>
          <p>Use the subscription tools above to fetch premium-only shelves and download curated guides. Once a subscription is active, the premium catalogue request button will display the exclusive collections available to you.</p>
          {{#if subscription}}
            <button class="btn waves-effect waves-light amber darken-2" id="load-premium" data-subscription-id="{{subscription.id}}">View premium shelves</button>
          {{/if}}
          <div id="premium-results"></div>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col s12">
      <h5 class="white-text">Explore other plans</h5>
    </div>
    {{#each plans}}
      <div class="col s12 m4">
        <div class="card grey darken-3">
          <div class="card-content white-text">
            <span class="card-title">{{name}}</span>
            <p class="price">${{displayPrice}} / {{billingInterval}}</p>
            <p>{{description}}</p>
          </div>
          <div class="card-action">
            <form class="membership-action" data-membership-action="activate" data-plan-id="{{id}}">
              <button class="btn waves-effect waves-light blue-grey lighten-1" type="submit">Switch to this plan</button>
            </form>
          </div>
        </div>
      </div>
    {{/each}}
  </div>
</div>
